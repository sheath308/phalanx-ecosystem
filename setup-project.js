#!/usr/bin/env node
const fs = require('fs');
const path = require('path');

const BASE_DIR = __dirname;

// Helper function to create directories
function createDir(dirPath) {
    if (!fs.existsSync(dirPath)) {
          fs.mkdirSync(dirPath, { recursive: true });
          console.log(`âœ“ Created directory: ${path.relative(BASE_DIR, dirPath)}`);
    }
}

// Helper function to write files
function writeFile(filePath, content) {
    const dir = path.dirname(filePath);
    if (!fs.existsSync(dir)) {
          fs.mkdirSync(dir, { recursive: true });
    }
    fs.writeFileSync(filePath, content, 'utf8');
    console.log(`âœ“ Created file: ${path.relative(BASE_DIR, filePath)}`);
}

console.log('ðŸš€ Starting Phalanx Ecosystem Map setup...\n');

// Create directory structure
const dirs = [
    'src/components',
    'src/hooks',
    'src/data',
    'src/security',
    'src/styles',
    'public',
    'scripts'
  ];

dirs.forEach(dir => createDir(path.join(BASE_DIR, dir)));

// Create index.html
writeFile(path.join(BASE_DIR, 'index.html'), `<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8" />
          <meta name="viewport" content="width=device-width, initial-scale=1.0" />
              <title>Phalanx Ecosystem Map</title>
                </head>
                  <body>
                      <div id="root"></div>
                          <script type="module" src="/src/main.jsx"><\/script>
                            </body>
                            </html>`);

// Create .env.example
writeFile(path.join(BASE_DIR, '.env.example'), `VITE_INTERNAL_PIN=4321
# VITE_DATA_URL=https://cms.example.com/api/ecosystem.json`);

// Create tailwind.config.js
writeFile(path.join(BASE_DIR, 'tailwind.config.js'), `/** @type {import('tailwindcss').Config} */
export default {
  content: [
      "./index.html",
          "./src/**/*.{js,jsx,ts,tsx}",
            ],
              theme: {
                  extend: {},
                    },
                      plugins: [],
                      }`);

// Create postcss.config.js
writeFile(path.join(BASE_DIR, 'postcss.config.js'), `export default {
  plugins: {
      tailwindcss: {},
          autoprefixer: {},
            },
            }`);

// Create src/main.jsx
writeFile(path.join(BASE_DIR, 'src/main.jsx'), `import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './styles/index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
      <App />
        </React.StrictMode>
        )`);

// Create src/styles/index.css
writeFile(path.join(BASE_DIR, 'src/styles/index.css'), `@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
          sans-serif;
            -webkit-font-smoothing: antialiased;
              -moz-osx-font-smoothing: grayscale;
              }`);

// Create src/data/provider.js
writeFile(path.join(BASE_DIR, 'src/data/provider.js'), `export async function loadEcosystem() {
  const dataUrl = import.meta.env.VITE_DATA_URL;

    try {
        if (dataUrl) {
              console.info(\`Loading ecosystem data from: \${dataUrl}\`);
                    const response = await fetch(dataUrl);

                          if (!response.ok) {
                                  throw new Error(\`HTTP \${response.status}: \${response.statusText}\`);
                                        }

                                              return await response.json();
                                                  } else {
                                                        console.info('Loading ecosystem data from local source');
                                                              const module = await import('./ecosystem.json');
                                                                    return module.default;
                                                                        }
                                                                          } catch (error) {
                                                                              console.error('Failed to load ecosystem data:', error);
                                                                                  throw new Error(\`Data loading failed: \${error.message}\`);
                                                                                    }
                                                                                    }

                                                                                    export function validateEcosystem(data) {
                                                                                      if (!data || typeof data !== 'object') {
                                                                                          throw new Error('Invalid data: must be an object');
                                                                                            }

                                                                                              if (!Array.isArray(data.nodes)) {
                                                                                                  throw new Error('Invalid data: nodes must be an array');
                                                                                                    }
                                                                                                    
                                                                                                      if (!Array.isArray(data.edges)) {
                                                                                                          throw new Error('Invalid data: edges must be an array');
                                                                                                            }
                                                                                                            
                                                                                                              const nodeIds = new Set();
                                                                                                                for (const node of data.nodes) {
                                                                                                                    if (nodeIds.has(node.id)) {
                                                                                                                          throw new Error(\`Duplicate node ID: \${node.id}\`);
                                                                                                                              }
                                                                                                                                  nodeIds.add(node.id);
                                                                                                                                    }
                                                                                                                                    
                                                                                                                                      for (const edge of data.edges) {
                                                                                                                                          if (!nodeIds.has(edge.source)) {
                                                                                                                                                throw new Error(\`Edge references unknown source: \${edge.source}\`);
                                                                                                                                                    }
                                                                                                                                                        if (!nodeIds.has(edge.target)) {
                                                                                                                                                              throw new Error(\`Edge references unknown target: \${edge.target}\`);
                                                                                                                                                                  }
                                                                                                                                                                    }
                                                                                                                                                                    
                                                                                                                                                                      return true;
                                                                                                                                                                      }
                                                                                                                                                                      
                                                                                                                                                                      export function filterByRole(data, role = 'public') {
                                                                                                                                                                        if (role === 'internal') {
                                                                                                                                                                            return data;
                                                                                                                                                                              }
                                                                                                                                                                              
                                                                                                                                                                                const publicNodes = data.nodes.filter(
                                                                                                                                                                                    node => node.metadata.visibility !== 'internal'
                                                                                                                                                                                      );
                                                                                                                                                                                      
                                                                                                                                                                                        const publicNodeIds = new Set(publicNodes.map(n => n.id));
                                                                                                                                                                                        
                                                                                                                                                                                          const publicEdges = data.edges.filter(
                                                                                                                                                                                              edge => publicNodeIds.has(edge.source) &&
                                                                                                                                                                                                          publicNodeIds.has(edge.target) &&
                                                                                                                                                                                                                      edge.metadata.visibility !== 'internal'
                                                                                                                                                                                                                        );
                                                                                                                                                                                                                        
                                                                                                                                                                                                                          return {
                                                                                                                                                                                                                              ...data,
                                                                                                                                                                                                                                  nodes: publicNodes,
                                                                                                                                                                                                                                      edges: publicEdges
                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                        }`);

// Create src/data/ecosystem.json
writeFile(path.join(BASE_DIR, 'src/data/ecosystem.json'), `{
  "version": "1.0.0",
    "lastUpdated": "2026-01-08T00:00:00Z",
      "metadata": {
          "title": "Phalanx Ecosystem Map",
              "description": "Interactive visualization of ecosystem relationships",
                  "author": "Phalanx Team"
                    },
                      "nodes": [
                          {
                                "id": "node-1",
                                      "type": "organization",
                                            "label": "Phalanx Core",
                                                  "category": "infrastructure",
                                                        "position": { "x": 400, "y": 200 },
                                                              "metadata": {
                                                                      "description": "Core infrastructure and platform",
                                                                              "url": "https://phalanx.example.com",
                                                                                      "status": "active",
                                                                                              "visibility": "public"
                                                                                                    },
                                                                                                          "styling": {
                                                                                                                  "color": "#3b82f6",
                                                                                                                          "icon": "Shield",
                                                                                                                                  "size": "large"
                                                                                                                                        }
                                                                                                                                            },
                                                                                                                                                {
                                                                                                                                                      "id": "node-2",
                                                                                                                                                            "type": "product",
                                                                                                                                                                  "label": "Analytics Engine",
                                                                                                                                                                        "category": "product",
                                                                                                                                                                              "position": { "x": 200, "y": 350 },
                                                                                                                                                                                    "metadata": {
                                                                                                                                                                                            "description": "Real-time data analytics platform",
                                                                                                                                                                                                    "url": "https://analytics.example.com",
                                                                                                                                                                                                            "status": "active",
                                                                                                                                                                                                                    "visibility": "public"
                                                                                                                                                                                                                          },
                                                                                                                                                                                                                                "styling": {
                                                                                                                                                                                                                                        "color": "#10b981",
                                                                                                                                                                                                                                                "icon": "BarChart3",
                                                                                                                                                                                                                                                        "size": "medium"
                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                  },
                                                                                                                                                                                                                                                                      {
                                                                                                                                                                                                                                                                            "id": "node-3",
                                                                                                                                                                                                                                                                                  "type": "product",
                                                                                                                                                                                                                                                                                        "label": "API Gateway",
                                                                                                                                                                                                                                                                                              "category": "infrastructure",
                                                                                                                                                                                                                                                                                                    "position": { "x": 600, "y": 350 },
                                                                                                                                                                                                                                                                                                          "metadata": {
                                                                                                                                                                                                                                                                                                                  "description": "Centralized API management",
                                                                                                                                                                                                                                                                                                                          "url": "https://api.example.com",
                                                                                                                                                                                                                                                                                                                                  "status": "active",
                                                                                                                                                                                                                                                                                                                                          "visibility": "public"
                                                                                                                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                                                                                                                      "styling": {
                                                                                                                                                                                                                                                                                                                                                              "color": "#f59e0b",
                                                                                                                                                                                                                                                                                                                                                                      "icon": "Network",
                                                                                                                                                                                                                                                                                                                                                                              "size": "medium"
                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                                                                                                                                                                            {
                                                                                                                                                                                                                                                                                                                                                                                                  "id": "node-4",
                                                                                                                                                                                                                                                                                                                                                                                                        "type": "service",
                                                                                                                                                                                                                                                                                                                                                                                                              "label": "Internal Tools",
                                                                                                                                                                                                                                                                                                                                                                                                                    "category": "internal",
                                                                                                                                                                                                                                                                                                                                                                                                                          "position": { "x": 400, "y": 500 },
                                                                                                                                                                                                                                                                                                                                                                                                                                "metadata": {
                                                                                                                                                                                                                                                                                                                                                                                                                                        "description": "Internal team management tools",
                                                                                                                                                                                                                                                                                                                                                                                                                                                "url": "https://internal.example.com",
                                                                                                                                                                                                                                                                                                                                                                                                                                                        "status": "active",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                "visibility": "internal"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "styling": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "color": "#8b5cf6",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "icon": "Wrench",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "size": "medium"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "edges": [
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "id": "edge-1",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "source": "node-1",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "target": "node-2",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "type": "integration",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "label": "Integrates with",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "metadata": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "strength": 8,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "visibility": "public",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "bidirectional": false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "styling": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "strokeWidth": 2,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "strokeDasharray": "",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "color": "#6b7280"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "id": "edge-2",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "source": "node-1",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "target": "node-3",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "type": "dependency",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "label": "Depends on",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "metadata": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "strength": 9,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "visibility": "public",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "bidirectional": false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "styling": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "strokeWidth": 3,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "strokeDasharray": "",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "color": "#6b7280"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "id": "edge-3",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "source": "node-2",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "target": "node-3",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "type": "partnership",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "label": "Partners with",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "metadata": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "strength": 7,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "visibility": "public",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "bidirectional": true
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "styling": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "strokeWidth": 2,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "strokeDasharray": "5,5",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "color": "#6b7280"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "id": "edge-4",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "source": "node-1",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "target": "node-4",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "type": "integration",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "label": "Uses internally",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "metadata": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "strength": 6,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "visibility": "internal",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "bidirectional": false
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "styling": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "strokeWidth": 2,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "strokeDasharray": "",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "color": "#6b7280"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "categories": [
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "slug": "infrastructure",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "label": "Infrastructure",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "color": "#3b82f6",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "visibility": "public"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "slug": "product",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "label": "Products",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "color": "#10b981",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "visibility": "public"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "slug": "internal",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "label": "Internal",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    "color": "#8b5cf6",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "visibility": "internal"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }`);

// Create src/security/roleGate.js
writeFile(path.join(BASE_DIR, 'src/security/roleGate.js'), `const STORAGE_KEY = 'phalanx_role';
const ROLES = {
  PUBLIC: 'public',
    INTERNAL: 'internal'
    };

    export function getRole() {
      try {
          const stored = localStorage.getItem(STORAGE_KEY);
              return stored === ROLES.INTERNAL ? ROLES.INTERNAL : ROLES.PUBLIC;
                } catch {
                    return ROLES.PUBLIC;
                      }
                      }

                      export function setRole(role) {
                        if (!Object.values(ROLES).includes(role)) {
                            throw new Error(\`Invalid role: \${role}\`);
                              }
                                try {
                                    localStorage.setItem(STORAGE_KEY, role);
                                      } catch (error) {
                                          console.error('Failed to persist role:', error);
                                            }
                                            }

                                            export function verifyPin(pin) {
                                              const correctPin = import.meta.env.VITE_INTERNAL_PIN;
                                                if (!correctPin) {
                                                    console.warn('VITE_INTERNAL_PIN not configured');
                                                        return false;
                                                          }
                                                            const isValid = pin === correctPin;
                                                              if (isValid) {
                                                                  setRole(ROLES.INTERNAL);
                                                                    }
                                                                      return isValid;
                                                                      }

                                                                      export function logout() {
                                                                        setRole(ROLES.PUBLIC);
                                                                        }

                                                                        export function isInternal() {
                                                                          return getRole() === ROLES.INTERNAL;
                                                                          }

                                                                          export { ROLES };`);

// Create src/hooks/useRole.js
writeFile(path.join(BASE_DIR, 'src/hooks/useRole.js'), `import { useState, useEffect } from 'react';
import { getRole, setRole, verifyPin, logout, ROLES } from '../security/roleGate';

export function useRole() {
  const [role, setRoleState] = useState(getRole());
    const [pinError, setPinError] = useState(null);

      useEffect(() => {
          setRoleState(getRole());
            }, []);

              const handlePinSubmit = (pin) => {
                  setPinError(null);
                      if (verifyPin(pin)) {
                            setRoleState(ROLES.INTERNAL);
                                  return true;
                                      } else {
                                            setPinError('Invalid PIN');
                                                  return false;
                                                      }
                                                        };

                                                          const handleLogout = () => {
                                                              logout();
                                                                  setRoleState(ROLES.PUBLIC);
                                                                    };

                                                                      return {
                                                                          role,
                                                                              isInternal: role === ROLES.INTERNAL,
                                                                                  pinError,
                                                                                      submitPin: handlePinSubmit,
                                                                                          logout: handleLogout
                                                                                            };
                                                                                            }`);

// Create src/hooks/useEcosystemData.js
writeFile(path.join(BASE_DIR, 'src/hooks/useEcosystemData.js'), `import { useState, useEffect } from 'react';
import { loadEcosystem, validateEcosystem, filterByRole } from '../data/provider';
import { useRole } from './useRole';

export function useEcosystemData() {
  const [data, setData] = useState(null);
    const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
        const { role } = useRole();

          useEffect(() => {
              let isMounted = true;

                  async function fetchData() {
                        try {
                                setLoading(true);
                                        setError(null);
                                                const rawData = await loadEcosystem();
                                                        validateEcosystem(rawData);
                                                                const filteredData = filterByRole(rawData, role);
                                                                        if (isMounted) {
                                                                                  setData(filteredData);
                                                                                          }
                                                                                                } catch (err) {
                                                                                                        console.error('Data loading error:', err);
                                                                                                                if (isMounted) {
                                                                                                                          setError(err.message);
                                                                                                                                  }
                                                                                                                                        } finally {
                                                                                                                                                if (isMounted) {
                                                                                                                                                          setLoading(false);
                                                                                                                                                                  }
                                                                                                                                                                        }
                                                                                                                                                                            }
                                                                                                                                                                            
                                                                                                                                                                                fetchData();
                                                                                                                                                                                
                                                                                                                                                                                    return () => {
                                                                                                                                                                                          isMounted = false;
                                                                                                                                                                                              };
                                                                                                                                                                                                }, [role]);
                                                                                                                                                                                                
                                                                                                                                                                                                  return { data, loading, error };
                                                                                                                                                                                                  }`);

// Create component files
writeFile(path.join(BASE_DIR, 'src/components/LoadingState.jsx'), `export function LoadingState() {
  return (
      <div className="flex items-center justify-center min-h-screen bg-gray-50">
            <div className="text-center">
                    <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto" />
                            <p className="mt-4 text-gray-600">Loading ecosystem data...</p>
                                  </div>
                                      </div>
                                        );
                                        }`);

writeFile(path.join(BASE_DIR, 'src/components/ErrorState.jsx'), `export function ErrorState({ error, onRetry }) {
  return (
      <div className="flex items-center justify-center min-h-screen bg-gray-50">
            <div className="bg-red-50 border border-red-200 rounded-lg p-6 max-w-md">
                    <h2 className="text-red-800 font-semibold mb-2">Failed to Load Data</h2>
                            <p className="text-red-600 text-sm mb-4">{error}</p>
                                    <button
                                              onClick={onRetry}
                                                        className="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition"
                                                                >
                                                                          Retry
                                                                                  </button>
                                                                                        </div>
                                                                                            </div>
                                                                                              );
                                                                                              }`);

writeFile(path.join(BASE_DIR, 'src/components/EcosystemMap.jsx'), `import { useMemo } from 'react';
import * as Icons from 'lucide-react';

export function EcosystemMap({ data, interactive = true, showLegend = true }) {
  const canvasSize = { width: 1000, height: 700 };

    const categoryMap = useMemo(() => {
        const map = {};
            data.categories.forEach(cat => {
                  map[cat.slug] = cat;
                      });
                          return map;
                            }, [data.categories]);

                              const renderNode = (node) => {
                                  const IconComponent = Icons[node.styling.icon] || Icons.Circle;
                                      const size = node.styling.size === 'large' ? 60 : node.styling.size === 'medium' ? 50 : 40;

                                          return (
                                                <g key={node.id}>
                                                        <circle
                                                                  cx={node.position.x}
                                                                            cy={node.position.y}
                                                                                      r={size / 2}
                                                                                                fill={node.styling.color}
                                                                                                          opacity="0.2"
                                                                                                                    stroke={node.styling.color}
                                                                                                                              strokeWidth="2"
                                                                                                                                      />
                                                                                                                                              <circle
                                                                                                                                                        cx={node.position.x}
                                                                                                                                                                  cy={node.position.y}
                                                                                                                                                                            r="4"
                                                                                                                                                                                      fill={node.styling.color}
                                                                                                                                                                                              />
                                                                                                                                                                                                      <text
                                                                                                                                                                                                                x={node.position.x}
                                                                                                                                                                                                                          y={node.position.y + size / 2 + 25}
                                                                                                                                                                                                                                    textAnchor="middle"
                                                                                                                                                                                                                                              className="text-xs font-semibold fill-gray-800"
                                                                                                                                                                                                                                                        maxLength={20}
                                                                                                                                                                                                                                                                >
                                                                                                                                                                                                                                                                          {node.label}
                                                                                                                                                                                                                                                                                  </text>
                                                                                                                                                                                                                                                                                        </g>
                                                                                                                                                                                                                                                                                            );
                                                                                                                                                                                                                                                                                              };
                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                const renderEdge = (edge) => {
                                                                                                                                                                                                                                                                                                    const source = data.nodes.find(n => n.id === edge.source);
                                                                                                                                                                                                                                                                                                        const target = data.nodes.find(n => n.id === edge.target);
                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                            if (!source || !target) return null;
                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                return (
                                                                                                                                                                                                                                                                                                                      <line
                                                                                                                                                                                                                                                                                                                              key={edge.id}
                                                                                                                                                                                                                                                                                                                                      x1={source.position.x}
                                                                                                                                                                                                                                                                                                                                              y1={source.position.y}
                                                                                                                                                                                                                                                                                                                                                      x2={target.position.x}
                                                                                                                                                                                                                                                                                                                                                              y2={target.position.y}
                                                                                                                                                                                                                                                                                                                                                                      stroke={edge.styling.color}
                                                                                                                                                                                                                                                                                                                                                                              strokeWidth={edge.styling.strokeWidth}
                                                                                                                                                                                                                                                                                                                                                                                      strokeDasharray={edge.styling.strokeDasharray}
                                                                                                                                                                                                                                                                                                                                                                                              opacity="0.6"
                                                                                                                                                                                                                                                                                                                                                                                                    />
                                                                                                                                                                                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                                                                                                                                                                                          };
                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                            return (
                                                                                                                                                                                                                                                                                                                                                                                                                <div className="w-full bg-white rounded-lg shadow-lg p-6">
                                                                                                                                                                                                                                                                                                                                                                                                                      <div className="flex justify-between items-center mb-4">
                                                                                                                                                                                                                                                                                                                                                                                                                              <h2 className="text-2xl font-bold text-gray-800">Ecosystem Map</h2>
                                                                                                                                                                                                                                                                                                                                                                                                                                      {showLegend && (
                                                                                                                                                                                                                                                                                                                                                                                                                                                <div className="flex gap-6">
                                                                                                                                                                                                                                                                                                                                                                                                                                                            {data.categories.map(cat => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div key={cat.slug} className="flex items-center gap-2">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            className="w-3 h-3 rounded-full"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              style={{ backgroundColor: cat.color }}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              />
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <span className="text-sm text-gray-600">{cat.label}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          )}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <svg
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              width={canvasSize.width}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      height={canvasSize.height}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              className="border border-gray-200 rounded bg-gray-50 mx-auto"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      viewBox={\`0 0 \${canvasSize.width} \${canvasSize.height}\`}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    {data.edges.map(renderEdge)}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            {data.nodes.map(renderNode)}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </svg>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <div className="mt-6 grid grid-cols-2 gap-4 max-h-40 overflow-y-auto">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                {data.nodes.map(node => (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <div key={node.id} className="text-xs p-2 bg-gray-50 rounded border border-gray-200">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <p className="font-semibold text-gray-800">{node.label}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <p className="text-gray-600">{node.metadata.description}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              {node.metadata.url && (
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            href={node.metadata.url}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            target="_blank"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            rel="noopener noreferrer"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            className="text-blue-600 hover:underline"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          View â†’
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </a>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    )}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }`);

writeFile(path.join(BASE_DIR, 'src/components/PinGate.jsx'), `import { useState } from 'react';
import { Lock, X } from 'lucide-react';

export function PinGate({ onSubmit, error }) {
  const [isOpen, setIsOpen] = useState(false);
    const [pin, setPin] = useState('');

      const handleSubmit = (e) => {
          e.preventDefault();
              if (onSubmit(pin)) {
                    setPin('');
                          setIsOpen(false);
                              }
                                };

                                  if (!isOpen) {
                                      return (
                                            <button
                                                    onClick={() => setIsOpen(true)}
                                                            className="fixed bottom-6 right-6 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition"
                                                                    title="Access internal view"
                                                                          >
                                                                                  <Lock size={20} />
                                                                                        </button>
                                                                                            );
                                                                                              }

                                                                                                return (
                                                                                                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                                                                                          <div className="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full mx-4">
                                                                                                                  <div className="flex justify-between items-center mb-4">
                                                                                                                            <h2 className="text-xl font-bold text-gray-800">Internal Access</h2>
                                                                                                                                      <button
                                                                                                                                                  onClick={() => {
                                                                                                                                                                setIsOpen(false);
                                                                                                                                                                              setPin('');
                                                                                                                                                                                          }}
                                                                                                                                                                                                      className="text-gray-400 hover:text-gray-600"
                                                                                                                                                                                                                >
                                                                                                                                                                                                                            <X size={20} />
                                                                                                                                                                                                                                      </button>
                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                      <p className="text-gray-600 text-sm mb-4">
                                                                                                                                                                                                                                                                Enter PIN to access internal ecosystem views
                                                                                                                                                                                                                                                                        </p>
                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                <form onSubmit={handleSubmit}>
                                                                                                                                                                                                                                                                                          <input
                                                                                                                                                                                                                                                                                                      type="password"
                                                                                                                                                                                                                                                                                                                  value={pin}
                                                                                                                                                                                                                                                                                                                              onChange={(e) => setPin(e.target.value)}
                                                                                                                                                                                                                                                                                                                                          placeholder="Enter PIN"
                                                                                                                                                                                                                                                                                                                                                      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 mb-3"
                                                                                                                                                                                                                                                                                                                                                                  autoFocus
                                                                                                                                                                                                                                                                                                                                                                            />
                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                      {error && (
                                                                                                                                                                                                                                                                                                                                                                                                  <p className="text-red-600 text-sm mb-3">{error}</p>
                                                                                                                                                                                                                                                                                                                                                                                                            )}
                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                      <button
                                                                                                                                                                                                                                                                                                                                                                                                                                  type="submit"
                                                                                                                                                                                                                                                                                                                                                                                                                                              className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition font-semibold"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Unlock
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </form>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }`);

writeFile(path.join(BASE_DIR, 'src/components/PublicView.jsx'), `import { EcosystemMap } from './EcosystemMap';
import { LoadingState } from './LoadingState';
import { ErrorState } from './ErrorState';
import { useEcosystemData } from '../hooks/useEcosystemData';

export function PublicView() {
  const { data, loading, error } = useEcosystemData();

    if (loading) {
        return <LoadingState />;
          }

            if (error) {
                return <ErrorState error={error} onRetry={() => window.location.reload()} />;
                  }

                    return (
                        <div className="min-h-screen bg-gray-50 p-8">
                              <div className="max-w-6xl mx-auto">
                                      <header className="mb-8">
                                                <h1 className="text-4xl font-bold text-gray-900 mb-2">
                                                            {data.metadata.title}
                                                                      </h1>
                                                                                <p className="text-gray-600">
                                                                                            {data.metadata.description}
                                                                                                      </p>
                                                                                                              </header>
                                                                                                              
                                                                                                                      {data && <EcosystemMap data={data} interactive={true} showLegend={true} />}
                                                                                                                      
                                                                                                                              <footer className="mt-8 text-center text-gray-500 text-sm">
                                                                                                                                        <p>Last updated: {new Date(data.lastUpdated).toLocaleDateString()}</p>
                                                                                                                                                </footer>
                                                                                                                                                      </div>
                                                                                                                                                          </div>
                                                                                                                                                            );
                                                                                                                                                            }
                                                                                                                                                            
                                                                                                                                                            export default PublicView;`);

writeFile(path.join(BASE_DIR, 'src/components/InternalView.jsx'), `import { EcosystemMap } from './EcosystemMap';
import { LoadingState } from './LoadingState';
import { ErrorState } from './ErrorState';
import { useEcosystemData } from '../hooks/useEcosystemData';
import { LogOut } from 'lucide-react';

export function InternalView({ onLogout }) {
  const { data, loading, error } = useEcosystemData();

    if (loading) {
        return <LoadingState />;
          }

            if (error) {
                return <ErrorState error={error} onRetry={() => window.location.reload()} />;
                  }

                    return (
                        <div className="min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-8">
                              <div className="max-w-6xl mx-auto">
                                      <header className="flex justify-between items-start mb-8">
                                                <div>
                                                            <div className="inline-block bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold mb-3">
                                                                          ðŸ”’ Internal View
                                                                                      </div>
                                                                                                  <h1 className="text-4xl font-bold text-gray-900 mb-2">
                                                                                                                {data.metadata.title}
                                                                                                                            </h1>
                                                                                                                                        <p className="text-gray-600">
                                                                                                                                                      {data.metadata.description} (including internal components)
                                                                                                                                                                  </p>
                                                                                                                                                                            </div>
                                                                                                                                                                            
                                                                                                                                                                                      <button
                                                                                                                                                                                                  onClick={onLogout}
                                                                                                                                                                                                              className="flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition"
                                                                                                                                                                                                                        >
                                                                                                                                                                                                                                    <LogOut size={18} />
                                                                                                                                                                                                                                                Logout
                                                                                                                                                                                                                                                          </button>
                                                                                                                                                                                                                                                                  </header>
                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                          {data && <EcosystemMap data={data} interactive={true} showLegend={true} />}
                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                  <div className="mt-8 bg-white rounded-lg shadow p-6">
                                                                                                                                                                                                                                                                                            <h2 className="text-lg font-bold text-gray-900 mb-4">Internal Entities</h2>
                                                                                                                                                                                                                                                                                                      <div className="grid grid-cols-2 gap-4">
                                                                                                                                                                                                                                                                                                                  {data.nodes
                                                                                                                                                                                                                                                                                                                                .filter(node => node.metadata.visibility === 'internal')
                                                                                                                                                                                                                                                                                                                                              .map(node => (
                                                                                                                                                                                                                                                                                                                                                              <div key={node.id} className="p-4 bg-purple-50 rounded-lg border border-purple-200">
                                                                                                                                                                                                                                                                                                                                                                                <p className="font-semibold text-purple-900">{node.label}</p>
                                                                                                                                                                                                                                                                                                                                                                                                  <p className="text-sm text-purple-700">{node.metadata.description}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                ))}
                                                                                                                                                                                                                                                                                                                                                                                                                                          </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                          <footer className="mt-8 text-center text-gray-500 text-sm">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <p>Last updated: {new Date(data.lastUpdated).toLocaleDateString()}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </footer>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        export default InternalView;`);

// Create src/App.jsx
writeFile(path.join(BASE_DIR, 'src/App.jsx'), `import { useRole } from './hooks/useRole';
import PublicView from './components/PublicView';
import InternalView from './components/InternalView';
import { PinGate } from './components/PinGate';

function App() {
  const { role, isInternal, submitPin, logout, pinError } = useRole();

    return (
        <div className="min-h-screen bg-gray-50">
              {isInternal ? (
                      <InternalView onLogout={logout} />
                            ) : (
                                    <>
                                              <PublicView />
                                                        <PinGate onSubmit={submitPin} error={pinError} />
                                                                </>
                                                                      )}
                                                                          </div>
                                                                            );
                                                                            }

                                                                            export default App;`);

// Create documentation files
writeFile(path.join(BASE_DIR, 'DEPLOY.md'), `# Phalanx Ecosystem Map - Deployment Guide

## Local Development

### Prerequisites
- Node.js 18+ installed
- npm or yarn

### Setup
\`\`\`bash
npm install
cp .env.example .env
\`\`\`

### Running Locally
\`\`\`bash
npm run dev
\`\`\`

## Vercel Deployment

### Step 1: Push to GitHub
\`\`\`bash
git add .
git commit -m "Initial commit: Phalanx Ecosystem Map"
git push -u origin main
\`\`\`

### Step 2: Connect to Vercel
1. Go to https://vercel.com/new
2. Import your GitHub repository
3. Add environment variables in Settings

### Step 3: Set Environment Variables
Add in Vercel Dashboard â†’ Settings â†’ Environment Variables:
- \`VITE_INTERNAL_PIN\` = your-secure-pin

### Step 4: Deploy
Push to main branch and Vercel auto-deploys!

## Custom Domain
1. Go to Project Settings â†’ Domains
2. Add your domain
3. Update DNS records per Vercel instructions`);

writeFile(path.join(BASE_DIR, 'README.md'), `# Phalanx Ecosystem Map

Interactive visualization of the Phalanx ecosystem with role-based public and internal views.

## Features

- ðŸ“Š Interactive ecosystem visualization
- ðŸ”’ PIN-protected internal view
- ðŸ“± Fully responsive design
- âš¡ Fast development with Vite
- ðŸš€ One-click Vercel deployment
- ðŸŽ¨ Beautiful UI with Tailwind CSS

## Quick Start

### Development

\`\`\`bash
npm install
cp .env.example .env
npm run dev
\`\`\`

Visit http://localhost:3000

### Production Build

\`\`\`bash
npm run build
npm run preview
\`\`\`

## Deployment

See [DEPLOY.md](./DEPLOY.md) for full deployment instructions.

## Tech Stack

- React 18 + Vite
- Tailwind CSS
- Vercel

## Project Structure

\`\`\`
src/
  â”œâ”€â”€ components/        # React components
    â”œâ”€â”€ hooks/            # Custom hooks
      â”œâ”€â”€ data/             # Data layer & ecosystem.json
        â”œâ”€â”€ security/         # Role management
          â””â”€â”€ styles/           # Tailwind CSS
          \`\`\`

          ## Environment Variables

          Create \`.env\` based on \`.env.example\`:
          - \`VITE_INTERNAL_PIN\` - PIN to unlock internal view
          - \`VITE_DATA_URL\` - (Optional) Remote data source URL

          ## License

          MIT`);

console.log('\nâœ… All files created successfully!');
console.log('\nðŸ“ Next steps:');
console.log('  1. npm install');
console.log('  2. npm run dev');
console.log('\nðŸš€ Happy coding!');
